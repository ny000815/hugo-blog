{{- $q := (.Get "q") | default "" | strings.TrimSpace -}}
{{- $text := (.Get "text") | default $q -}}

{{- if not $q -}}
  {{- errorf "mercari shortcode: q is required" -}}
{{- else -}}
  {{- $encoded := replace $q " " "%20" -}}
  {{- $href := printf "https://jp.mercari.com/search?keyword=%s" $encoded -}}
  <a href="{{ $href | safeURL }}">{{ $text }}</a>
{{- end -}}

